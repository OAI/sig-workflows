workflows: 1.0.0
info:
  title: title
  summary: summary
  description: desc
  version: 1.0.0

sources:
  api1: http://somesite/path/
  api2: http://somesite/path/

procedures:
  summary: Login User
  description: This procedure lays out the steps to login a user
  procedureId: loginUser
  inputs: 
      type: object
      properties:
          username:
              type: string
          password:
              type: string
  steps:
    - stepId: loginStep
      description: This step demonstrates the user login step
      operationId: loginUser
      parameters:
          # parameters to inject into the loginUser operation (parameter name must be resolvable at the referenced operation and the value is determined using {expression} syntax)
          username: $inputs.username
          password: $inputs.password
      successCriteria:
          # assertions to determine step was successful (see open question 3 in Appendix B)
          $statusCode == 200
      outputs:
          # outputs from this step
          tokenExpires: $response.header.X-Expires-After
          rateLimit: $response.header.X-Rate-Limit
          sessionToken: $response.body
    - stepId: getPetStep
      description: retrieve a pet by status from the GET pets endpoint
      operationRef: https://petstore3.swagger.io/api/v3/openapi.json#/paths/users/~findbystatus~1{status}/get
      parameters:
          status: 'available'
          '{$request.header.Authorization}': $steps.loginUser.outputs.sessionToken
      successCriteria:
        - $statusCode == 200
      outputs:
          # outputs from this step
          availablePets: $response.body
  outputs:
      tokenExpires: $steps.loginStep.outputs.tokenExpires


